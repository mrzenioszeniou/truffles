!function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):factory(window.jQuery)}(function($){$.fn.numeric=function(config,callback){"boolean"==typeof config&&(config={decimal:config,negative:!0,decimalPlaces:-1}),config=config||{},"undefined"==typeof config.negative&&(config.negative=!0);var decimal=config.decimal===!1?"":config.decimal||".",negative=config.negative===!0,decimalPlaces="undefined"==typeof config.decimalPlaces?-1:config.decimalPlaces;return callback="function"==typeof callback?callback:function(){},this.data("numeric.decimal",decimal).data("numeric.negative",negative).data("numeric.callback",callback).data("numeric.decimalPlaces",decimalPlaces).keypress($.fn.numeric.keypress).keyup($.fn.numeric.keyup).blur($.fn.numeric.blur)},$.fn.numeric.keypress=function(e){var decimal=$.data(this,"numeric.decimal"),negative=$.data(this,"numeric.negative"),decimalPlaces=$.data(this,"numeric.decimalPlaces"),key=e.charCode?e.charCode:e.keyCode?e.keyCode:0;if(13==key&&"input"==this.nodeName.toLowerCase())return!0;if(13==key)return!1;if(35==key||36==key||37==key)return!1;var allow=!1;if(e.ctrlKey&&97==key||e.ctrlKey&&65==key)return!0;if(e.ctrlKey&&120==key||e.ctrlKey&&88==key)return!0;if(e.ctrlKey&&99==key||e.ctrlKey&&67==key)return!0;if(e.ctrlKey&&122==key||e.ctrlKey&&90==key)return!0;if(e.ctrlKey&&118==key||e.ctrlKey&&86==key||e.shiftKey&&45==key)return!0;if(key<48||key>57){var value=$(this).val();if(0!==$.inArray("-",value.split(""))&&negative&&45==key&&(0===value.length||0===parseInt($.fn.getSelectionStart(this),10)))return!0;decimal&&key==decimal.charCodeAt(0)&&$.inArray(decimal,value.split(""))!=-1&&(allow=!1),8!=key&&9!=key&&13!=key&&35!=key&&36!=key&&37!=key&&39!=key&&46!=key?allow=!1:"undefined"!=typeof e.charCode&&(e.keyCode==e.which&&0!==e.which?(allow=!0,46==e.which&&(allow=!1)):0!==e.keyCode&&0===e.charCode&&0===e.which&&(allow=!0)),decimal&&key==decimal.charCodeAt(0)&&(allow=$.inArray(decimal,value.split(""))==-1)}else if(allow=!0,decimal&&decimalPlaces>0){var selectionStart=$.fn.getSelectionStart(this),selectionEnd=$.fn.getSelectionEnd(this),dot=$.inArray(decimal,$(this).val().split(""));selectionStart===selectionEnd&&dot>=0&&selectionStart>dot&&$(this).val().length>dot+decimalPlaces&&(allow=!1)}return allow},$.fn.numeric.keyup=function(e){var val=$(this).val();if(val&&val.length>0){var carat=$.fn.getSelectionStart(this),selectionEnd=$.fn.getSelectionEnd(this),decimal=$.data(this,"numeric.decimal"),negative=$.data(this,"numeric.negative"),decimalPlaces=$.data(this,"numeric.decimalPlaces");if(""!==decimal&&null!==decimal){var dot=$.inArray(decimal,val.split(""));0===dot&&(this.value="0"+val,carat++,selectionEnd++),1==dot&&"-"==val.charAt(0)&&(this.value="-0"+val.substring(1),carat++,selectionEnd++),val=this.value}for(var validChars=[0,1,2,3,4,5,6,7,8,9,"-",decimal],length=val.length,i=length-1;i>=0;i--){var ch=val.charAt(i);0!==i&&"-"==ch?val=val.substring(0,i)+val.substring(i+1):0!==i||negative||"-"!=ch||(val=val.substring(1));for(var validChar=!1,j=0;j<validChars.length;j++)if(ch==validChars[j]){validChar=!0;break}validChar&&" "!=ch||(val=val.substring(0,i)+val.substring(i+1))}var firstDecimal=$.inArray(decimal,val.split(""));if(firstDecimal>0)for(var k=length-1;k>firstDecimal;k--){var chch=val.charAt(k);chch==decimal&&(val=val.substring(0,k)+val.substring(k+1))}if(decimal&&decimalPlaces>0){var dot=$.inArray(decimal,val.split(""));dot>=0&&(val=val.substring(0,dot+decimalPlaces+1),selectionEnd=Math.min(val.length,selectionEnd))}this.value=val,$.fn.setSelection(this,[carat,selectionEnd])}},$.fn.numeric.blur=function(){var decimal=$.data(this,"numeric.decimal"),callback=$.data(this,"numeric.callback"),negative=$.data(this,"numeric.negative"),val=this.value;if(""!==val){var re=new RegExp("^"+(negative?"-?":"")+"\\d+$|^"+(negative?"-?":"")+"\\d*"+decimal+"\\d+$");re.exec(val)||callback.apply(this)}},$.fn.removeNumeric=function(){return this.data("numeric.decimal",null).data("numeric.negative",null).data("numeric.callback",null).data("numeric.decimalPlaces",null).unbind("keypress",$.fn.numeric.keypress).unbind("keyup",$.fn.numeric.keyup).unbind("blur",$.fn.numeric.blur)},$.fn.getSelectionStart=function(o){if("number"!==o.type){if(o.createTextRange&&document.selection){var r=document.selection.createRange().duplicate();return r.moveEnd("character",o.value.length),""==r.text?o.value.length:Math.max(0,o.value.lastIndexOf(r.text))}try{return o.selectionStart}catch(e){return 0}}},$.fn.getSelectionEnd=function(o){if("number"!==o.type){if(o.createTextRange&&document.selection){var r=document.selection.createRange().duplicate();return r.moveStart("character",-o.value.length),r.text.length}return o.selectionEnd}},$.fn.setSelection=function(o,p){if("number"==typeof p&&(p=[p,p]),p&&p.constructor==Array&&2==p.length)if("number"===o.type)o.focus();else if(o.createTextRange){var r=o.createTextRange();r.collapse(!0),r.moveStart("character",p[0]),r.moveEnd("character",p[1]-p[0]),r.select()}else{o.focus();try{o.setSelectionRange&&o.setSelectionRange(p[0],p[1])}catch(e){}}}}),function($){function _create($blocks){$blocks.each(function(index,item){var $block=$(item),$switcher=$block.find(".js-toggle-switcher");$block.data("initToggler")||($block.data({initToggler:!0}),_bindEvents($switcher))})}function _bindEvents($switcher){$switcher.click(function(e){var $toggleBlock=$switcher.closest(".js-toggle"),expanded=$toggleBlock.hasClass("toggled");$toggleBlock.toggleClass("toggled",!expanded),$switcher.html(expanded?$switcher.data("toggle-off"):$switcher.data("toggle-on")),e.preventDefault()})}function _init(options){$.extend(_options,_defaults,options),_create($(this))}var _options={},_methods={init:_init},_defaults={};$.fn.toggler=function(method){return"object"!=typeof method&&method?_methods[method]?_methods[method].apply(this,Array.prototype.slice.call(arguments,1)):void $.error(method+" is not a method of jQuery.toggler"):_methods.init.apply(this,arguments)}}(jQuery),app.modules.mapListing=function(self){function _getPoints(success){var key,search=$(_options.selectors.form).serialize().replace(/(\&|\?|^)page=[0-9]*/i,"").replace(/(\&|\?)cities=all*/i,"").replace(/^\&/i,""),params=$(_options.selectors.params).data("params-for-map");for(key in params)!params[key]&&delete params[key];_$map.addClass(_options.loadingClass),$.get(_options.url,search+(search?"&":"")+$.param(params)).then(function(response){success(response),_$map.removeClass(_options.loadingClass)})}function _setSizeMap(){_mobile?_$map.css({top:$("header").outerHeight(!0)}).height($win.height()-_$map.offset().top):_$map.css({top:$("header").outerHeight(!0)+$(".listing-traits").outerHeight(!0)+$(".search-list-sorting").outerHeight(!0)}).addClass(_options.activeClass).height($win.outerHeight(!0)-_$map.offset().top)}function _init(){_setSizeMap(),_points?_$map.addClass(_options.activeClass):_getPoints(function(response){_points=response.results||[],$.getScript(app.config.mapApiUrl).then(function(){_pointsIntoRange(_points)})})}function _reinit(){_points&&_map&&(_$map.is(":visible")&&_setSizeMap(),_getPoints(function(response){$.each(_markers,function(index,point){point.remove()}),_points=response.results||[],_createMarkers(_points)}))}function _createMarkers(points){var mark=$(_options.selectors.map).data("mark"),myIcon=L.icon({iconUrl:mark,iconSize:[23,31]});$.each(points,function(index,data){data.geometry&&_markers.push(L.marker([data.geometry[0],data.geometry[1]],{icon:myIcon,title:data.title+" "+data.price}).bindPopup($("<div>").addClass("listing__map-popup").append(data.image&&$("<a>").attr({target:"_blank",href:data.absolute_url}).append($("<img>").addClass("listing__map-popup-image").attr({src:data.image})),$("<a>").addClass("listing__map-popup-link").attr({target:"_blank",href:data.absolute_url}).text(data.title),$("<span>").addClass("listing__map-popup-price").text(data.price)).html()).on("mouseover",function(){this.openPopup()}).on("mouseout",function(e){!$(e.originalEvent.relatedTarget).closest(".leaflet-popup-pane").length&&this.closePopup()}).addTo(_map))})}function _initMap(points){_map=L.map("map",{zoomControl:!1,trackResize:!1,closeOnClick:!1}).setView(new L.LatLng(_center.lat,_center.lng),_zoom);var mutant=L.gridLayer.googleMutant({type:"roadmap"}).addTo(_map);$(".leaflet-popup-pane").on("mouseout",function(event){!$(event.relatedTarget).closest(".leaflet-popup-pane").length&&_map.closePopup()}),L.control.zoom({position:"bottomright"}).addTo(_map),mutant.on("spawned",function(event){_googleMap=event.mapObject}),_createMarkers(points)}function _calcCenterAndZoom(min,max,height){var zoom,latDistance,lngDistance,width=_$map.outerWidth(!0);for(_center={lat:min.lat+(max.lat-min.lat)/2,lng:min.lng+(max.lng-min.lng)/2},latDistance=111e3*(max.lat-min.lat),lngDistance=(max.lng-min.lng)*(4e4*Math.cos(min.lat*Math.PI/180)/360*1e3),zoom=0;zoom<=20&&!(latDistance/(156543.03392*Math.cos(min.lat*Math.PI/180)/Math.pow(2,zoom))>height);zoom++);for(_zoom=Math.min(_zoom,zoom-1),zoom=0;zoom<=20&&!(lngDistance/(156543.03392*Math.cos(min.lng*Math.PI/180)/Math.pow(2,zoom))>width);zoom++);_zoom=Math.min(_zoom,zoom-1)}function _pointsIntoRange(points){var height,hasGeometry=!1,range=_$map.data("range"),max={lat:-90,lng:-180},min={lat:90,lng:180};return!_map&&($.each(points||[],function(index,data){return data.geometry[0]>range.lat[1]||data.geometry[0]<range.lat[0]||data.geometry[1]>range.lng[1]||data.geometry[1]<range.lng[0]||void(data.geometry&&(data.geometry[0]>max.lat&&(max.lat=data.geometry[0]),data.geometry[0]<min.lat&&(min.lat=data.geometry[0]),data.geometry[1]>max.lng&&(max.lng=data.geometry[1]),data.geometry[1]<min.lng&&(min.lng=data.geometry[1]),hasGeometry=!0))}),height=_mobile?_$map.outerHeight(!0):_$map.outerHeight(!0)-50,hasGeometry?_calcCenterAndZoom(min,max,height):_calcCenterAndZoom({lat:range.lat[0],lng:range.lng[0]},{lat:range.lat[1],lng:range.lng[1]},height),void _initMap(points))}function _showMapMobile(){_$switcher=$(_options.selectors.switcher).eq(0),_$switcherParent=_$switcher.prev(),_$map.addClass(_options.activeClass),$("body").addClass("show-map").prepend(_$switcher),_init(),_map&&_map.invalidateSize(),_googleMap&&google.maps.event.trigger(_googleMap,"resize"),window.ga&&ga("send","event","User_mobile","Map_listing",$.trim($(".js-single-item__location").text()))}function _showListMobile(){$("body").removeClass("show-map"),_$map.removeClass(_options.activeClass),_$switcherParent&&_$switcherParent.after(_$switcher)}function _showMap(){$doc.scrollTop(0),$("body").addClass("show-map"),_init(),$win.resize(),_googleMap&&google.maps.event.trigger(_googleMap,"resize");var breadcrumbs=$.makeArray($(".breadcrumbs a").map(function(index,item){return $(item).text()}))||[];breadcrumbs.shift(),window.ga&&ga("send","event","User_desktop","Map_listing",breadcrumbs.join(" > "))}function _showList(){$("body").removeClass("show-map"),_$map.removeClass(_options.activeClass)}function _switch(){$(_options.selectors.switcherItem).removeClass(_options.activeClass),"map"===$(this).addClass(_options.activeClass).data("state")?$(_options.selectors.controls).removeClass("dn"):$(_options.selectors.controls).addClass("dn"),_mobile?"map"===$(this).addClass(_options.activeClass).data("state")?_showMapMobile():_showListMobile():"map"===$(this).addClass(_options.activeClass).data("state")?_showMap():_showList();var state=$(this).data("state");$.cookie("type_view","map"!==state?state:""),"map"===state?$doc.trigger("listing:switch-map",[]):$doc.trigger("change:switch")}function _showMapShop(){$(".js-map-popup-shop").dialog({modal:!0,width:app.config.mobile?"100%":680,height:"auto",dialogClass:"author_business__map-dialog",open:function(){if(_initMapShop)return!1;var init=function(){var map,$map=$("#map-shop"),center={lat:+$map.data("position-lat"),lng:+$map.data("position-lng")};map=new google.maps.Map($map[0],{zoom:16,center:center,scrollwheel:!0,navigationControl:!1,mapTypeControl:!1,draggable:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.LARGE}}),new google.maps.Marker({map:map,position:center,draggable:!0,icon:$(_options.selectors.map).data("mark")})};_initMapShop=!0,window.google&&google.maps?init():$.getScript(app.config.mapApiUrl).then(function(){init()})}})}function _listing(){$doc.on("successLoad:listing",_reinit).on("click",_options.selectors.showMapShop,_showMapShop).on("click",_options.selectors.switcherItem,_switch),_$map.length&&$win.on("resize",function(){_$map.is(":visible")&&(_$map.height($win.height()-_$map.offset().top).width($win.width()),_map&&_map.invalidateSize(),_googleMap&&google.maps.event.trigger(_googleMap,"resize"))})}var _map,_googleMap,_points,_$map,_$switcher,_$switcherParent,_mobile,_zoom=16,_center={lat:90,lng:180},_markers=[],_initMapShop=!1,_options={url:"/api/items/adverts-geometry/",selectors:{map:"#map",form:".js-search-main, .js-index-form",advert:".js-advert-listing",title:".js-title-listing",filter:".js-filter",switcher:".js-switcher",switcherItem:".js-item-switcher",orderDropdown:".js-order-dropdown",params:"[data-params-for-map]",controls:".js-left-controls",showMapShop:".js-show-map-shop"},activeClass:"_active",loadingClass:"_loading"};return self.ready=function(){_mobile=$("body").hasClass("mobile"),_$map=$(_options.selectors.map),_mobile&&_$map.height($win.height()-$("header").outerHeight(!0));try{var search=new URI(location.search);search.query(!0).type_view&&$.cookie("type_view",search.query(!0).type_view)}catch(e){}_listing()},self}(app.modules.mapListing||{}),app.modules.sliderArrow=function(self){function _clickArrow(){var count,$arrow=$(this).addClass("js-no-click"),$sibling=$arrow.siblings(".js-arrow-image-top").addClass("js-no-click"),$wrapper=$arrow.closest(".js-announcement-block-img"),data=$arrow.data(),delta=data.count<3?data.count:3,$img=$wrapper.find(".js-image-top:eq(0)");data.count?($img.css({marginLeft:(data.arrow<0?"-=":"+=")+delta*($wrapper.width()/3)}),count=data.count-delta,$arrow.data({count:count}).toggleClass("_hide",!count),count=$sibling.data("count")||0,$sibling.data({count:count+delta}).toggleClass("_hide",!(count+delta)),setTimeout(function(){$arrow.removeClass("js-no-click"),$sibling.removeClass("js-no-click")},500)):($arrow.removeClass("js-no-click"),$sibling.removeClass("js-no-click"))}function _listener(){$doc.on("click",_options.selectors.arrow,_clickArrow)}var _options={selectors:{arrow:".js-arrow-image-top:not(.js-no-click)"}};return self.ready=function(){_listener()},self}(app.modules.sliderArrow||{}),app.modules.filter=function(self){function _beforeSendAjaxCallback(){$(_options.selectors.listing).addClass("loading"),$(_options.selectors.progressBar).addClass("preload"),$doc.trigger("reload:listing")}function _loadTop(){var tops=[],$topContainer=$(".list-title__top-container");return $topContainer.length?($topContainer.each(function(count,item){tops.push($.ajax({url:$(item).data("url"),method:"GET",cache:!1,success:function(response){$(item).html(response)}}))}),$.when(tops).then(function(){$doc.trigger("successLoadTop:listing"),_updateSizeBannerRange()})):($doc.trigger("listing:empty-top-ready"),$.Deferred().resolve())}function _setFavoritesUrl(reqUrl,friendlyUrl){var $searchSaveButton=$(".js-save-search");$searchSaveButton.attr("data-request",reqUrl).attr("data-friendly",friendlyUrl)}function _setView(){var view=$.cookie("type_view"),$inputView=$(_options.selectors.form).find(_options.selectors.inputView);view?(!$inputView.length&&$(_options.selectors.form).prepend($('<input type="hidden" name="type_view" value="">')),$(_options.selectors.form).find(_options.selectors.inputView).val(view)):$inputView.remove()}function _loadSimple(){_setView(),$(_options.selectors.mark).add(_options.selectors.model).prop({disabled:!0});var extUrl=$(_options.selectors.rubric).val()?app.config.filterUrl:$(_options.selectors.form).attr("action"),serializedData=$(_options.selectors.form).serialize();return $.ajax({url:extUrl,method:"GET",data:serializedData,cache:!0,beforeSend:_beforeSendAjaxCallback,success:function(response){var $input=$(".js-query-search"),$categoryDropdown=$(".category-dropdown"),$icon=$categoryDropdown.find(".dd-label .category-icon").clone();window.history&&history.pushState&&history.pushState("","",response.full_url),$("title").text(response.meta_info.page_title),$(_options.selectors.listing).html(response.listing),$(_options.selectors.traits).html(response.traits),$(".index-text-inner").html(response.seo_text),$(".js-rubric-cities").replaceWith(response.rubric_cities),$(".js-rubric-district").replaceWith(response.rubric_districts),$(".js-suggest-result").addClass("dn"),$('[name="c"]').val(response.query_count||0),$input.attr({placeholder:(response.query_count_fmt||0)+$input.data("default")}),$(_options.selectors.mark).add(_options.selectors.model).prop({disabled:!1}),$(".js-search-main").attr("data-author",response.author_page_url).data({author:response.author_page_url}),$('.js-ordering-filter[data-sort="relevant"]').toggleClass("dn",!($(_options.selectors.inputOrder).val()&&$.trim($input.val()))),!$(_options.selectors.inputOrder).val()&&$(_options.selectors.activeOrdering).text($.trim($input.val())?$(_options.selectors.activeOrdering).data("empty"):$('.js-ordering-filter[data-sort="newest"]').text()),$(".blur").removeClass("blur"),response.rubric&&$categoryDropdown.children(".dd-label").html(response.rubric).prepend($icon),_init(),_setFavoritesUrl(extUrl+"?"+serializedData,response.full_url)}})}function _load(event,callback,page){$(_options.selectors.inputPage).val(page||1),_beforeSendAjaxCallback(),_loadSimple().done(function(){_loadTop().done(function(){$(_options.selectors.progressBar).removeClass("preload loaded"),$doc.trigger("initDropdowns").trigger("successLoad:listing"),$(".banner-container-two").remove(),$(".banner-container-three").remove(),_updateSizeBannerRange(),callback&&callback()})})}function _submit(){return _load(),!1}function _insertBanner(name,$parent,height){var banners=$("<div>").addClass(name);$parent.children("div").each(function(index,item){banners.append($(item).clone().empty().addClass("js-banner"))}),_$rightList.append(banners),$doc.trigger("successLoad:listing"),$("."+name).css({top:height,position:"absolute"})}function _bannerController(){if(_scroll=$win.scrollTop()-_offsetTop,!_$bannerContainer||!_$bannerContainer.length)return!1;var y=window.pageYOffset+$win.height()+$(".js-footer").outerHeight(!0)+$(".js-rubric-district").outerHeight(!0)+$(".js-rubric-cities").outerHeight(!0);if($(".js-to-top-button").toggleClass("dn",!(window.pageYOffset>150)).css({bottom:y>$doc.outerHeight(!0)?y-$doc.outerHeight(!0)+22:22}),_scroll<=0)return _$bannerContainer.css({top:"auto",position:"static"}),!1;var $banner3=$(".banner-container-three");return _scroll>3*_height-($banner3.length?$banner3.outerHeight(!0):_$bannerContainer.outerHeight(!0))?($banner3.length?$banner3.css({top:3*_height-$banner3.outerHeight(!0),position:"absolute"}):_$bannerContainer.css({top:3*_height-_$bannerContainer.outerHeight(!0),position:"absolute"}),!1):($banner3.length||_$bannerContainer.css({top:10,position:"fixed"}),_scroll>_height-_$bannerContainer.outerHeight(!0)-10&&2*_$bannerContainer.outerHeight(!0)<_height&&_height>500&&(_$bannerContainer.css({top:_height-_$bannerContainer.outerHeight(!0)+10,position:"absolute"}),!$(".banner-container-two").length&&_insertBanner("banner-container-two",_$bannerContainer,_height)),_scroll>2*_height-$(".banner-container-two").outerHeight(!0)-10&&2*_$bannerContainer.outerHeight(!0)<_height&&_height>500&&($(".banner-container-two").css({top:2*_height-$(".banner-container-two").outerHeight(!0)+10,position:"absolute"}),!$(".banner-container-three").length&&_insertBanner("banner-container-three",_$bannerContainer,2*_height)),void(_scroll>_height?_scroll<2*_height-$(".banner-container-two").outerHeight(!0)?($(".banner-container-two").css({top:10,position:"fixed"}),$(".banner-container-three").css({top:2*_height+10,position:"absolute"})):($(".banner-container-two").css({top:2*_height-$(".banner-container-two").outerHeight(!0)+10,position:"absolute"}),_scroll>2*_height?$(".banner-container-three").css({top:10,position:"fixed"}):$(".banner-container-three").css({top:2*_height+10,position:"absolute"})):(_scroll>_height-_$bannerContainer.outerHeight(!0)||_$bannerContainer.css({top:10,position:"fixed"}),$(".banner-container-two").css({top:_height+10,position:"absolute"}),$(".banner-container-three").css({top:2*_height+10,position:"absolute"}))))}function _ordering(){var $ordering=$(this);$(_options.selectors.ordering).removeClass(_options.activeClass),$(_options.selectors.activeOrdering).text("relevant"!==$ordering.data("sort")?$ordering.addClass(_options.activeClass).text():$(_options.selectors.activeOrdering).data("empty")),$(_options.selectors.inputOrder).val("relevant"!==$ordering.data("sort")?$ordering.data("sort"):""),_load()}function _changePage(){return _load(null,function(){$("html, body").animate({scrollTop:$("#listing").offset().top})},$(this).data("page")),!1}function _changeRubric(){var $rubric=$(this),id=$rubric.val();"model"===$rubric.attr("name")&&null===id&&(id=$(_options.selectors.mark).val()),"mark"===$rubric.attr("name")&&null===id&&(id=$(_options.selectors.parentRubric).data("parent")),$(_options.selectors.rubric).val(id)}function _changeSelect(){$(this).closest(".js-dropdown").toggleClass("checked",!!$(this).val()),_load()}function _clickBusinessFilter(){$(_options.selectors.businessFilter).removeClass(_options.activeClass);var type=$(this).addClass(_options.activeClass).data("type");$(_options.selectors.inputBusiness).val(type).prop({disabled:!type}),_load()}function _listener(){$doc.on("change",_options.selectors.mark,_changeRubric).on("change",_options.selectors.model,_changeRubric).on("change",_options.selectors.trait,_load).on("change",_options.selectors.select,_changeSelect).on("click",_options.selectors.ordering,_ordering).on("click",_options.selectors.page,_changePage).on("click",_options.selectors.businessFilter,_clickBusinessFilter).on("submit",_options.selectors.form,_submit).on("change:switch",_submit),$win.scroll(_bannerController).on("popstate",function(){location.reload()})}function _updateSizeBannerRange(){setTimeout(function(){_$bannerContainer=$(".banner-container"),_$rightList=$(".list-announcement-right--list"),_offsetTop=_$rightList.offset().top,_height=_$rightList.outerHeight(!0)/3},300)}function _init(){$(_options.selectors.listing).removeClass(_options.loadingClass),$(".js-toggle").toggler(),$(".banner-container").length&&_updateSizeBannerRange()}var _$bannerContainer,_$rightList,_offsetTop,_scroll,_height,_options={selectors:{listing:"#listing",traits:"#trait_fields",form:".js-search-main:not(.js-stores-form)",trait:".js-trait-field",traitAjax:".js-ajax-link-custom",select:".js-select-filter",progressBar:".js-progress-bar",ordering:".js-ordering-filter",inputOrder:'[name="ordering"]',inputPage:'[name="page"]',page:".js-page-filter",activeOrdering:".js-active-ordering",rubric:'[name="rubric"]',mark:'.js-select-filter[name="mark"]',model:'.js-select-filter[name="model"]',parentRubric:".js-select-filter[data-parent]:last",businessFilter:".js-business-filter",inputBusiness:'[name="business"]',inputView:'[name="type_view"]'},loadingClass:"loading",activeClass:"_active"};return self.ready=function(){_listener(),_init(),_loadTop()},self}(app.modules.filter||{});